<!DOCTYPE html>
<html lang="en">

<body>
    <h2>Audio Recorder</h2>
    <button id="startBtn">Start Recording</button>
    <button id="stopBtn" disabled>Stop Recording</button>

    <br><br>
    <audio id="audioPlayback" controls></audio>

    <script src="script.js"></script>
</body>

</html>

<script>
    let mediaRecorder;
    let audioChunks = [];

    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const audioPlayback = document.getElementById('audioPlayback');

    startBtn.addEventListener('click', async() => {
        // 1. Request microphone access
        const stream = await navigator.mediaDevices.getUserMedia({
            audio: true
        });

        // 2. Initialize the MediaRecorder
        mediaRecorder = new MediaRecorder(stream);

        // 3. Data handling: Push chunks of audio into our array as they become available
        mediaRecorder.ondataavailable = (event) => {
            audioChunks.push(event.data);
        };

        // 4. On stop: Combine chunks into a single Blob and create a URL
        mediaRecorder.onstop = () => {
            const audioBlob = new Blob(audioChunks, {
                type: 'audio/wav'
            });
            const audioUrl = URL.createObjectURL(audioBlob);
            audioPlayback.src = audioUrl;
            audioChunks = []; // Reset for next recording
        };

        mediaRecorder.start();
        startBtn.disabled = true;
        stopBtn.disabled = false;
    });

    stopBtn.addEventListener('click', () => {
        mediaRecorder.stop();
        startBtn.disabled = false;
        stopBtn.disabled = true;
    });
</script>